{"version":3,"sources":["assets\\BuyWork\\Script\\Shop.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import BookDetail from \"./BookDetail\";\r\nimport BookItem from \"./BookItem\";\r\nimport { BookData, BookListData } from \"./DataType\";\r\nimport HomePage from \"./HomePage\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Shop extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    content: cc.Node = null;\r\n\r\n    @property(BookDetail)\r\n    detail: BookDetail = null;\r\n\r\n    @property(cc.Prefab)\r\n    bookItem: cc.Prefab = null;\r\n\r\n    shopData: BookListData = null;\r\n    root: HomePage = null;\r\n    uid: string = ''\r\n    setRoot(root: HomePage) {\r\n        this.root = root;\r\n        this.detail.setRoot(root);\r\n    }\r\n    setData(sd: BookListData,uid) {\r\n        this.uid = uid\r\n        this.shopData = sd;\r\n        this.updateUI();\r\n    }\r\n    updateUI() {\r\n        let data = this.shopData.data;\r\n        const items = this.content.children.reduce((arr, child, i) => {\r\n            arr[child.name] = child;\r\n            return arr;\r\n        }, {})\r\n        for (let i = 0; i < data.length; i++) {\r\n            const bookData = data[i];\r\n            let child = items[i.toString()];\r\n            if (child) {\r\n                child.getComponent(BookItem).setData(bookData);\r\n                delete items[child.name]\r\n            } else {\r\n                let node = this.createNode(bookData.id);\r\n                node.getComponent(BookItem).setData(bookData);\r\n            }\r\n        }\r\n        for (let itemName in items) {\r\n            items[itemName].destroy();\r\n        }\r\n    }\r\n\r\n    createNode(name: string) {\r\n        let node = cc.instantiate(this.bookItem);\r\n        node.name = name;\r\n        this.content.addChild(node);\r\n        return node;\r\n    }\r\n    \r\n\r\n    onShowDetial(bd: BookData) {\r\n        let pd = this.root.getPageData();\r\n        if (pd.isTourist) {\r\n            this.root.showTips('游客只有查看权限，请注册登录');\r\n            return;\r\n        }\r\n        this.detail.node.active = true;\r\n        this.detail.setData(bd,this.uid);\r\n    }\r\n    onHideDetial() {\r\n        this.detail.node.active = false;\r\n    }\r\n\r\n    // update (dt) {}\r\n}\r\n"]}