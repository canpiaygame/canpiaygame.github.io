{"version":3,"sources":["assets\\BuyWork\\Script\\BookDetail.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import { BookData, EventAct, IMG } from \"./DataType\";\r\nimport HomePage from \"./HomePage\";\r\nimport Net from \"./Net\";\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class BookDetail extends cc.Component {\r\n\r\n    @property(cc.Label)\r\n    bookName: cc.Label = null;\r\n    @property(cc.Label)\r\n    price: cc.Label = null;\r\n    @property(cc.Label)\r\n    publishingHouse: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    isbn: cc.Label = null;\r\n    @property(cc.Label)\r\n    dec: cc.Label = null;\r\n\r\n    @property(cc.Sprite)\r\n    pic: cc.Sprite = null;\r\n\r\n    @property(cc.Label)\r\n    num: cc.Label = null;\r\n    bookData: BookData;\r\n    edNum = 1;\r\n    uid: string = ''\r\n    setData(bd: BookData, uid: string) {\r\n        this.bookData = bd;\r\n        this.edNum = 1;\r\n        this.uid = uid;\r\n        this.updateUI();\r\n    }\r\n    root: HomePage = null;\r\n    setRoot(root: HomePage) {\r\n        this.root = root;\r\n    }\r\n    updateUI() {\r\n        this.bookName.string = `书名：《${this.bookData.name}》`;\r\n        this.price.string = `价格：《${this.bookData.unitPrice}》`;\r\n        this.publishingHouse.string = `出版社：${this.bookData.publishingHouse}`;\r\n        this.isbn.string = `isbn：${this.bookData.isbn}`;\r\n        this.dec.string = `简介：${this.bookData.description}`;\r\n        let path = IMG.getImg((parseInt(this.bookData.cover)));\r\n        cc.loader.loadRes(path, cc.Texture2D, (error: Error, resource: any) => {\r\n            let spf = new cc.SpriteFrame;\r\n            spf.setTexture(resource);\r\n            this.pic.spriteFrame = spf;\r\n        });\r\n        this.num.string = this.edNum.toString();\r\n    }\r\n\r\n\r\n    closeBtn() {\r\n        this.node.active = false;\r\n    }\r\n\r\n\r\n    left() {\r\n        if (this.edNum - 1 >= 1) {\r\n            this.edNum = this.edNum - 1;\r\n        }\r\n        this.updateUI();\r\n    }\r\n\r\n    right() {\r\n        if (this.edNum + 1 <= 99) {\r\n            this.edNum = this.edNum + 1;\r\n        }\r\n        this.updateUI();\r\n    }\r\n\r\n    async buy() {\r\n        this.root.node.emit(EventAct.ShowLoading);\r\n        let reslut = await Net.buyBook(this.uid, this.bookData.id, this.edNum);\r\n        if (reslut) {\r\n            this.root.showTips('购买成功！');\r\n        } else {\r\n            this.root.showTips('购买失败！请重试');\r\n        }\r\n        this.root.node.emit(EventAct.HideLoading);\r\n        this.closeBtn();\r\n    }\r\n    // update (dt) {}\r\n}\r\n"]}